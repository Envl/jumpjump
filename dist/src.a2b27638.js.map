{"version":3,"sources":["src/mode2Questions.js","src/question.js","src/index.js"],"names":["question","answers","value","isCorrect","console","log","byId","id","document","getElementById","page","selectMode","Mode1Rule","Mode2Rule","Mode1Game","Mode2Game","onclick","changePageTo","pageName","allPages","Object","keys","forEach","pn","style","display","game2","mode2Questions","start","HIT_UNIT","timeOut","questions","root","counter","querySelector","querySelectorAll","el","handleClick","bind","step","info","renderQuestion","intervalId","setInterval","innerText","stillQuestionLeft","fail","length","end","current","Array","from","idx","dataset","event","target","hit","miss","clearInterval","video","startBtn","select","cap","src","dst","streaming","gotDevices","mediaDevices","innerHTML","appendChild","createElement","count","mediaDevice","kind","option","deviceId","label","textNode","createTextNode","stopMediaTracks","stream","getTracks","track","stop","currentStream","videoStarted","videoConstraints","facingMode","exact","constraints","audio","navigator","getUserMedia","then","mediaStream","srcObject","enumerateDevices","catch","error","evt","cv","tick","setTimeout","task","VideoCapture","Mat","height","width","CV_8UC4","delete","gray","faces","classifier","begin","Date","now","read","copyTo","cvtColor","COLOR_RGBA2GRAY","detectMultiScale","i","size","face","get","point1","Point","x","y","point2","rectangle","imshow","delay","FPS","processVideo","err"],"mappings":";;AEQA,ADGA;;;;ACXA,IAAM2D,KAAK,GAAGnD,GFAC,CACb,IEDoB,CAACC,cAAT,CAAwB,OAAxB,CAAd;AACA,AFCIT,EAAAA,EEDE4D,MFCM,EEDE,AFCA,GEDGpD,QAAQ,CAACC,cAAT,CAAwB,IFAvC,IEAe,CAAjB;AACA,AFCIR,EAAAA,EEDE4D,KFCK,CEDC,CFCC,CACP,CEFSrD,QAAQ,CAACC,cAAT,CAAwB,QAAxB,CAAf;AACA,AFEQP,IEFJ4D,AFEI5D,GEFR,EFEa,EAAE,OADT;AEAN,AFEQC,IEFJ4D,AFEI5D,GEFR,MFEiB,EAAE;AEDnB,AFDM,GADO,CEET6D,CFGE,EEHN;AACA,AFGQ9D,ACTRE,ICMI6D,AFGI/D,GCTD,CAACG,CDSK,EAAE,ACTf,CAAY,CCMC,GAAG,CDNhB,CDQM,EEFN;AFIQF,IAAAA,SAAS,EAAE;AEAnB,AFFM,ACNN,GDCa,CCDPG,CDUA,GCVI,CCQD4D,EDRI,QCQb,CAAoBC,ADRd7D,IAAO,CAAAC,EAAE,KCQf,EAAkC;AAChCsD,AFEM3D,ACXO,ECSb2D,EFEM3D,IEFA,CAACkE,AFEI,ACXM5D,EDWJ,MCXY,CCSzB,AFCI,ACVsBC,GCSP,EAAnB,SDTiB,CAAwBF,EAAxB,CAAJ;ACUbsD,AFEM1D,ACZO,CAAf,CCUE0D,EFEM1D,IEFA,CAACkE,IFEQ,EAAE,KEFjB,CAAmB7D,QAAQ,CAAC8D,aAAT,CAAuB,QAAvB,CAAnB;AACA,AFDI,GATO,GEUPC,KAAK,GAAG,CAAZ;AACAJ,AFbA,ACGF,CDJe,CEcbA,CFIA,CCdIzD,IAAI,GAAG,GCUC,CAACY,OAAb,CAAqB,UAAAkD,WAAW,EAAI;AAClC,AFIAxE,ACdFW,EDcEX,ACdFW,MCUM6D,EFII,EAAE,ACdF,EAAE,IADD,CCWM,CAACC,IAAZ,KAAqB,YAAzB,EAAuC,cFGzC;AEFI,AFIFxE,ACdFW,EDcEX,ACdFW,ODcS,CEJC8D,CFIC,ACdF,CDeL,CCfO,GCUK,EDZL,CCYQlE,QAAQ,CAAC8D,aAAT,CAAuB,QAAvB,CAAf;AACAI,AFKExE,ACfNW,EAAAA,EDeMX,EELFwE,GFKO,EAAE,ACfJ,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","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["export default [\n  {\n    question: 'What is the weather tomorrow?',\n    answers: [\n      {\n        value: 'Sunny',\n        isCorrect: 1,\n      },\n      {\n        value: 'Rainy',\n        isCorrect: 0,\n      },\n      {\n        value: 'Windy',\n        isCorrect: 0,\n      },\n    ],\n  },\n  {\n    question: 'What is the weather the day after tomorrow?',\n    answers: [\n      {\n        value: 'Sunny',\n        isCorrect: 1,\n      },\n      {\n        value: 'Rainy',\n        isCorrect: 0,\n      },\n      {\n        value: 'Windy',\n        isCorrect: 0,\n      },\n    ],\n  },\n]\n","console.log(12345)\n\nconst byId = id => document.getElementById(id)\n\nconst page = {\n  selectMode: true,\n  Mode1Rule: false,\n  Mode2Rule: false,\n  Mode1Game: false,\n  Mode2Game: true,\n}\nimport mode2Questions from './mode2Questions'\n\nbyId('mode1').onclick = () => changePageTo('Mode1Game')\nbyId('mode2').onclick = () => changePageTo('Mode2Game')\n\nconst changePageTo = (pageName, ...options) => {\n  const allPages = Object.keys(page)\n  allPages.forEach(pn => {\n    byId(pn).style.display = 'none'\n    page[pn] = false\n  })\n  page[pageName] = true\n  byId(pageName).style.display = 'block'\n  if (pageName === 'Mode2Game') {\n    const game2 = new Mode2Game(15, mode2Questions)\n    game2.start()\n    return game2\n  }\n}\n\nconst HIT_UNIT = 10\n\nclass Mode2Game {\n  constructor(timeOut = 10, questions) {\n    this.timeOut = timeOut\n    this.root = byId('Mode2Game')\n    this.questions = questions\n    this.counter = document.querySelector('#Mode2Game .timer')\n    this.question = document.querySelector('#Mode2Game .question')\n    this.answers = document.querySelectorAll('#Mode2Game .answer')\n    this.answers.forEach(el => (el.onclick = this.handleClick.bind(this)))\n    this.step = 0\n    this.info = document.querySelector('#Mode2Game .info')\n  }\n\n  get status() {\n    return this.intervalId ? (this.timeOut > 0 ? 'Playing' : 'Over') : 'Pending'\n  }\n\n  get stillQuestionLeft() {\n    return this.step < this.questions.length\n  }\n\n  start() {\n    this.renderQuestion()\n    this.intervalId = setInterval(() => {\n      this.timeOut -= 1\n      this.counter.innerText = this.timeOut\n      if (this.timeOut === 0 && this.stillQuestionLeft) {\n        this.fail()\n      }\n    }, 1000)\n  }\n\n  renderQuestion() {\n    if (this.step === this.questions.length) {\n      this.end()\n      return\n    }\n    const current = this.questions[this.step]\n    this.question.innerText = current.question\n    const answers = Array.from(this.answers)\n    answers.forEach((el, idx) => {\n      el.innerText = current.answers[idx].value\n      el.dataset.isCorrect = current.answers[idx].isCorrect\n      // change x and y here\n    })\n    this.step += 1\n  }\n\n  handleClick(event) {\n    const { isCorrect } = event.target.dataset\n    if (isCorrect == 1) {\n      console.log(isCorrect)\n      this.hit()\n    } else {\n      this.miss()\n    }\n    this.renderQuestion()\n  }\n\n  hit() {\n    this.timeOut += HIT_UNIT\n  }\n\n  miss() {\n    this.timeOut -= HIT_UNIT\n  }\n\n  end() {\n    clearInterval(this.intervalId)\n    this.info.innerText = 'Game Completed!'\n  }\n\n  fail() {\n    this.info.innerText = 'Game Over'\n    clearInterval(this.intervalId)\n  }\n}\n","const video = document.getElementById('video')\nconst startBtn = document.getElementById('button')\nconst select = document.getElementById('select')\nlet cap\nlet src\nlet dst\nlet streaming = true\n\nimport questionEffect from './question'\n\nfunction gotDevices(mediaDevices) {\n  select.innerHTML = ''\n  select.appendChild(document.createElement('option'))\n  let count = 1\n  mediaDevices.forEach(mediaDevice => {\n    if (mediaDevice.kind === 'videoinput') {\n      const option = document.createElement('option')\n      option.value = mediaDevice.deviceId\n      const label = mediaDevice.label || `Camera ${count++}`\n      const textNode = document.createTextNode(label)\n      option.appendChild(textNode)\n      select.appendChild(option)\n    }\n  })\n}\nfunction stopMediaTracks(stream) {\n  stream.getTracks().forEach(track => {\n    track.stop()\n  })\n}\nlet currentStream\nstartBtn.onclick = event => {\n  videoStarted = true\n  if (typeof currentStream !== 'undefined') {\n    stopMediaTracks(currentStream)\n    console.log('stop')\n  }\n  const videoConstraints = {}\n  if (select.value === '') {\n    videoConstraints.facingMode = 'environment'\n  } else {\n    videoConstraints.deviceId = { exact: select.value }\n  }\n  const constraints = {\n    video: videoConstraints,\n    audio: false,\n  }\n  navigator.mediaDevices\n    .getUserMedia(constraints)\n    .then(mediaStream => {\n      document.querySelector('video').srcObject = mediaStream\n      currentStream = mediaStream\n      return navigator.mediaDevices.enumerateDevices()\n    })\n    .then(gotDevices)\n    .catch(error => {\n      console.error(error)\n    })\n}\nnavigator.mediaDevices.enumerateDevices().then(gotDevices)\n\ndocument.querySelector('.stop').onclick = evt => {\n  streaming = false\n}\n\nlet videoStarted = false\n// do all your cv work here, after loading cv.js\ncv['onRuntimeInitialized'] = () => {\n  // function waiter() {\n  //   console.log('tick')\n  //   if (videoStarted) task()\n  //   else setTimeout(waiter, 500)\n  // }()\n  ;(function tick() {\n    console.log('tick')\n    if (videoStarted) setTimeout(task, 2000)\n    else setTimeout(tick, 500)\n  })()\n  function task() {\n    cap = new cv.VideoCapture(video)\n    src = new cv.Mat(video.height, video.width, cv.CV_8UC4)\n    dst = new cv.Mat(video.height, video.width, cv.CV_8UC4)\n    // cv processing\n    setTimeout(() => {\n      try {\n        if (!streaming) {\n          // clean and stop.\n          console.log('cleaning up')\n          src.delete()\n          dst.delete()\n          gray.delete()\n          faces.delete()\n          classifier.delete()\n          return\n        }\n        let begin = Date.now()\n        // start processing.\n        cap.read(src)\n        src.copyTo(dst)\n        cv.cvtColor(dst, gray, cv.COLOR_RGBA2GRAY, 0)\n        // detect faces.\n        classifier.detectMultiScale(gray, faces, 1.1, 3, 0)\n        // draw faces.\n        for (let i = 0; i < faces.size(); ++i) {\n          let face = faces.get(i)\n          let point1 = new cv.Point(face.x, face.y)\n          let point2 = new cv.Point(face.x + face.width, face.y + face.height)\n          cv.rectangle(dst, point1, point2, [255, 0, 0, 255])\n        }\n        cv.imshow('canvasOutput', dst)\n        // schedule the next one.\n        let delay = 1000 / FPS - (Date.now() - begin)\n        setTimeout(processVideo, delay)\n      } catch (err) {\n        console.error(err)\n      }\n    }, 0)\n  }\n}\n"]}